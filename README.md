#  Бронирование билетов

Командная работа https://github.com/AnnaKPolyakova/graduate_work

Здорово будет связать фильмы с походами в кино. Не всем нравится сидеть дома и 
смотреть фильмы в одиночку. 
Иногда хочется их посмотреть с компанией единомышленников.
Для реализации такой возможности создан отдельный микросервис с помощью 
которого можно создавать события и бронировать на них билеты. 

[Исследование по выбору bd](research.md)

Пользователям доступны следующие действия:
- города: создание (удаление, изменение) с указанием часового пояса 
  (доступно только суперпользователям). Просмотр списка городов (для всех)
- места: проведения событий: создание (изменение, удаление, просмотр) с 
  указанием адреса и города, где они будут являться хостами. Для просмотра 
  списка можно использовать фильтр по городу
- события: создание (удаление, изменение) события с указанием места сбора, 
  фильма, возможного количества участников. События можно фильтровать по 
  хосту, месту, дате начала проведения
- хосты: просмотр списка организаторов мероприятий (хостов), том числе своих 
  мероприятий (тех не чьи мероприятия ходил request user) с возможностью 
  фильтрации по городу
- черный список: хост может добавить другого пользователя в черный список и 
  тогда он не сможет создать бронирование на его событие
- бронирование билетов: регистрация на мероприятия (изменение регистрации, 
  удаление). Удалить свое бронирование может сам user или хост. Можно 
  получить все бронирования (доступная фильтрация по user, event, host) или 
  только свои бронирования (доступная фильтрация по host)

Сортировка выдачи объектов:
Доступна сортировка по любым полям объектов, или при запросе хостов - 
сортировка по id

Ограничения:
- нельзя создать мероприятие на прошедшее время и дату 
(с учетом часовых поясов в разных городах)
- нельзя зарегистрироваться на мероприятие, если все места уже заняты или 
  оно уже прошло
- нельзя удалить город, мероприятие, если существуют связанные объекты

Технологии и требования:
```
Python 3.9+
flask
```
### Настройки Docker

##### Установка

* [Подробное руководство по установке](https://docs.docker.com/install/linux/docker-ce/ubuntu/)

### Настройки Docker-compose

##### Установка

* [Подробное руководство по установке](https://docs.docker.com/compose/install/)

### Запуск приложения

#### Перед запуском проекта создаем переменные окружения
Создаем в корне .env и добавляем в него необходимые переменные  
Пример в .env.example - для запуска приложения целиком в docker  
Пример в .env.example-local - для запуска приложения локально и частично в docker

#### Запуск полностью в контейнерах docker: 

* `docker-compose up -d --build`

Для остановки контейнера:  
* `docker-compose down --rmi all --volumes`


#### Запуск проекта частично в контейнерах docker

* `docker-compose -f docker-compose-local.yml up -d --build`

Для остановки контейнера:  
* `docker-compose -f docker-compose-local.yml down --rmi all --volumes`


Документация по адресу:

http://127.0.0.1:8000/v1/doc/redoc/
http://127.0.0.1:8000/v1/doc/swagger/


### Тесты

#### Запуск тестов частично в контейнерах docker

* `docker-compose -f docker-compose-local.yml up -d --build`
* `pytest`

Для остановки контейнера:  
* `docker-compose -f docker-compose-local.yml down --rmi all --volumes`


#### Запуск тестов в контейнерах docker

* `docker-compose -f tests/functional/docker-compose-test.yml up -d --build`

Для остановки контейнера:  
* `docker-compose -f tests/functional/docker-compose-test.yml down --rmi all --volumes`

